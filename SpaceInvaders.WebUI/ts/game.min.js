define(["require","exports","GameObjects"],function(n,t,i){var r=i,u=function(){function n(){this.NUMBER_OF_STARS=50,this.FPS=10,this.enemies=[],this.playerBullets=[],this.player=new r.GameObjects.Player,this.canvas=document.getElementById("canvas"),this.playBaseHeight=20,this.playBaseColor="blue",this.spaceColor="black",this.stars=[],this.rightDown=!1,this.leftDown=!1,this.space=!1,this.context2D=this.canvas.getContext("2d"),this.canvas.width=n.CANVAS_WIDTH,this.canvas.height=n.CANVAS_HEIGHT,this.initGame()}return n.CANVAS_WIDTH=600,n.CANVAS_HEIGHT=800,n.prototype.onKeyDown=function(n){if(n.keyCode==39?this.rightDown=!0:n.keyCode==37&&(this.leftDown=!0),n.keyCode==32){this.space=!0;var t=new r.GameObjects.Bullet(10);this.addProjectile(t)}},n.prototype.onKeyUp=function(n){n.keyCode==39&&(this.rightDown=!1),n.keyCode==37&&(this.leftDown=!1),n.keyCode==32&&(this.space=!1)},n.prototype.update=function(n){var t=n/10;this.rightDown&&console.log(this.rightDown),console.log(this.rightDown),this.space&&this.player.shoot(),this.leftDown&&(this.player.xVelocity=-1,this.player.x-=this.player.xVelocity*t),this.rightDown&&(this.player.xVelocity=1,this.player.x+=this.player.xVelocity*t),this.playerBullets.forEach(function(n){n.update()}),this.playerBullets=this.playerBullets.filter(function(n){return n.active}),this.enemies=this.enemies.filter(function(n){return n.active}),this.updateEnemies(),this.draw()},n.prototype.initGame=function(){this.player.x=0,this.player.y=n.CANVAS_HEIGHT-this.playBaseHeight-this.player.height,this.player.OnShoot=function(n){this.playerBullets.push(n)},this.nextWave(),this.createStars()},n.prototype.drawBackground=function(){this.context2D.fillStyle=this.spaceColor,this.context2D.fillRect(0,0,n.CANVAS_WIDTH,n.CANVAS_HEIGHT),this.context2D.fillStyle=this.playBaseColor,this.context2D.fillRect(0,n.CANVAS_HEIGHT-this.playBaseHeight,n.CANVAS_WIDTH,this.playBaseHeight)},n.prototype.addEnemy=function(n){this.enemies.push(n)},n.prototype.nextWave=function(){for(var n,i,t=0;t<=6;t++)for(n=0;n<=3;n++)i=n==0?new r.GameObjects.Enemy(10+t*34,40+n*25,r.GameObjects.Enemy.BOSS_color):new r.GameObjects.Enemy(10+t*34,40+n*25,r.GameObjects.Enemy.BOSS_color),this.addEnemy(i);this.enemies.forEach(function(n){n.xVelocity=1})},n.prototype.reverseEnemyWaveAndDropDown=function(){this.enemies.forEach(function(n){n.xVelocity=n.xVelocity*-1,n.y+=n.height})},n.prototype.createStars=function(){for(var t=0;t<=this.NUMBER_OF_STARS;t++){var i=Math.round(Math.random()*n.CANVAS_WIDTH),u=Math.round(Math.random()*n.CANVAS_HEIGHT),f=new r.GameObjects.Star(i,u);this.stars.push(f)}},n.prototype.addProjectile=function(n){this.playerBullets.push(n)},n.prototype.collides=function(n,t){return n.x<t.x+t.width&&n.x+n.width>t.x&&n.y<t.y+t.height&&n.y+n.height>t.y},n.prototype.handleCollisions=function(){this.playerBullets.forEach(function(n){this.enemies.forEach(function(t){this.collides(n,t)&&(n.active=!1)})})},n.prototype.draw=function(){this.drawBackground(),this.player.draw(this.context2D);var n=this;this.stars.forEach(function(t){t.draw(n.context2D)}),this.enemies.forEach(function(t){t.draw(n.context2D)})},n.prototype.willAtLeastOneEmemyLeaveBoundsOnNextUpdate=function(){for(var t=0;t<this.enemies.length;t++)if(this.enemies[t].x<=0||this.enemies[t].x>=n.CANVAS_WIDTH-this.enemies[t].width)return!0;return!1},n.prototype.updateEnemies=function(){this.willAtLeastOneEmemyLeaveBoundsOnNextUpdate()&&this.reverseEnemyWaveAndDropDown(),this.enemies.forEach(function(n){n.x+=n.xVelocity*2})},n}();$(document).ready(function(){var n=new u,t;$(document).keydown(n.onKeyDown),$(document).keyup(n.onKeyUp),t=(new Date).getTime(),setInterval(function(){var i=(new Date).getTime(),r=i-t;n.update(r),n.draw()},1e3/this.FPS)})})